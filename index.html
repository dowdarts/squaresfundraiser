<!DOCTYPE html>
<html lang="en">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>SquareFund - Digital Squares. Zero Fees.</title>
    <script src="https://cdn.jsdelivr.net/npm/@supabase/supabase-js@2"></script>
    <style>
        :root {
            --primary-orange: #f97316;
            --background-dark: #121212;
            --card-bg: #1a1a1a;
            --border-color: rgba(255, 255, 255, 0.05);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: -apple-system, BlinkMacSystemFont, 'Segoe UI', 'Roboto', 'Oxygen', 'Ubuntu', sans-serif;
            background-color: var(--background-dark);
            color: #e2e8f0;
            min-height: 100vh;
            line-height: 1.6;
        }

        ::selection {
            background-color: var(--primary-orange);
            color: white;
        }

        /* Floating Help Button */
        .floating-help-btn {
            position: fixed;
            bottom: 24px;
            right: 24px;
            width: 60px;
            height: 60px;
            background: linear-gradient(135deg, #f97316 0%, #f39200 100%);
            border-radius: 50%;
            border: none;
            box-shadow: 0 8px 24px rgba(249, 115, 22, 0.4);
            cursor: pointer;
            z-index: 9998;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.3s ease;
            animation: pulse-help 2s infinite;
        }

        .floating-help-btn:hover {
            transform: scale(1.1);
            box-shadow: 0 12px 32px rgba(249, 115, 22, 0.6);
        }

        .floating-help-btn svg {
            width: 28px;
            height: 28px;
            color: white;
        }

        @keyframes pulse-help {
            0%, 100% { box-shadow: 0 8px 24px rgba(249, 115, 22, 0.4); }
            50% { box-shadow: 0 8px 32px rgba(249, 115, 22, 0.7); }
        }

        /* Helper Modal */
        .helper-modal {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            width: 100%;
            height: 100%;
            background: rgba(0, 0, 0, 0.85);
            z-index: 9999;
            backdrop-filter: blur(4px);
        }

        .helper-modal.active {
            display: flex;
            align-items: center;
            justify-content: center;
            animation: fadeIn 0.3s ease;
        }

        .helper-modal iframe {
            width: 95%;
            height: 95%;
            max-width: 1400px;
            max-height: 900px;
            border: none;
            border-radius: 16px;
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        .helper-close {
            position: absolute;
            top: 20px;
            right: 20px;
            width: 40px;
            height: 40px;
            background: rgba(255, 255, 255, 0.1);
            border: 1px solid rgba(255, 255, 255, 0.2);
            border-radius: 50%;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            transition: all 0.2s;
        }

        .helper-close:hover {
            background: rgba(249, 115, 22, 0.9);
            transform: rotate(90deg);
        }

        .helper-close svg {
            width: 20px;
            height: 20px;
            color: white;
        }

        /* Navigation */
        nav {
            position: fixed;
            top: 0;
            width: 100%;
            z-index: 1000;
            transition: all 0.3s ease;
            padding: 1.25rem 0;
        }

        nav.scrolled {
            background-color: rgba(26, 26, 26, 0.95);
            backdrop-filter: blur(12px);
            border-bottom: 1px solid var(--border-color);
            padding: 0.75rem 0;
        }

        .nav-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: flex;
            align-items: center;
            justify-content: space-between;
        }

        .nav-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
            cursor: pointer;
            transition: transform 0.2s;
        }

        .nav-logo:hover {
            transform: scale(1.05);
        }

        .nav-logo-img {
            background: white;
            padding: 0.25rem;
            border-radius: 0.375rem;
            height: 32px;
            width: auto;
        }

        .nav-logo-text {
            font-size: 1.25rem;
            font-weight: 900;
            letter-spacing: -0.05em;
            color: white;
            text-transform: uppercase;
            font-style: italic;
        }

        .nav-logo-text span {
            color: var(--primary-orange);
        }

        .nav-desktop {
            display: none;
            align-items: center;
            gap: 2rem;
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        @media (min-width: 768px) {
            .nav-desktop {
                display: flex;
            }
        }

        .nav-link {
            color: white;
            text-decoration: none;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            transition: color 0.2s;
            background: none;
            border: none;
            cursor: pointer;
            font-weight: 700;
            font-size: 0.75rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        .nav-link:hover {
            color: var(--primary-orange);
        }

        .nav-btn {
            background-color: var(--primary-orange);
            color: white;
            padding: 0.625rem 1.5rem;
            border-radius: 0.5rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-size: 0.75rem;
            border: none;
            cursor: pointer;
            box-shadow: 0 10px 15px -3px rgba(249, 115, 22, 0.3);
            transition: all 0.2s;
        }

        .nav-btn:hover {
            background-color: #ea580c;
        }

        .nav-btn:active {
            transform: scale(0.95);
        }

        .mobile-menu-btn {
            display: block;
            padding: 0.5rem;
            color: white;
            background: none;
            border: none;
            cursor: pointer;
        }

        @media (min-width: 768px) {
            .mobile-menu-btn {
                display: none;
            }
        }

        .mobile-menu {
            background-color: var(--card-bg);
            border-bottom: 1px solid var(--border-color);
            padding: 1.5rem;
            display: flex;
            flex-direction: column;
            gap: 1.5rem;
        }

        .mobile-menu.hidden {
            display: none;
        }

        /* Hero Section */
        .hero {
            position: relative;
            padding-top: 8rem;
            padding-bottom: 5rem;
            overflow: hidden;
            border-bottom: 1px solid var(--border-color);
        }

        .hero-container {
            max-width: 1280px;
            margin: 0 auto;
            padding: 0 1.5rem;
            display: grid;
            gap: 4rem;
            align-items: center;
        }

        @media (min-width: 1024px) {
            .hero-container {
                grid-template-columns: 1fr 1fr;
            }
        }

        .hero-content {
            position: relative;
            z-index: 10;
        }

        .hero-badge {
            display: inline-flex;
            align-items: center;
            gap: 0.5rem;
            padding: 0.25rem 0.75rem;
            border-radius: 0.375rem;
            background-color: var(--primary-orange);
            color: white;
            font-weight: 900;
            font-size: 0.625rem;
            text-transform: uppercase;
            letter-spacing: 0.2em;
            margin-bottom: 1.5rem;
        }

        .hero-title {
            font-size: 3rem;
            font-weight: 900;
            line-height: 0.95;
            letter-spacing: -0.05em;
            color: white;
            text-transform: uppercase;
            font-style: italic;
            margin-bottom: 2rem;
        }

        @media (min-width: 768px) {
            .hero-title {
                font-size: 4.5rem;
            }
        }

        .hero-title span {
            color: var(--primary-orange);
        }

        .hero-description {
            margin-top: 2rem;
            font-size: 1.125rem;
            color: #94a3b8;
            line-height: 1.7;
            max-width: 36rem;
            font-weight: 500;
        }

        .hero-buttons {
            margin-top: 2.5rem;
            display: flex;
            flex-wrap: wrap;
            gap: 1rem;
        }

        .hero-cta-primary {
            background-color: white;
            color: black;
            padding: 1rem 2rem;
            border-radius: 0.75rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-size: 0.875rem;
            display: flex;
            align-items: center;
            gap: 0.5rem;
            border: none;
            cursor: pointer;
            box-shadow: 0 25px 50px -12px rgba(255, 255, 255, 0.05);
            transition: all 0.2s;
        }

        .hero-cta-primary:hover {
            background-color: #e2e8f0;
        }

        .hero-feature-badge {
            display: flex;
            align-items: center;
            gap: 1rem;
            padding: 0 1.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            background-color: rgba(255, 255, 255, 0.05);
            height: 3.5rem;
        }

        .hero-feature-text {
            font-size: 0.625rem;
            font-weight: 700;
            color: #cbd5e1;
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        /* Demo Board */
        .demo-board {
            position: relative;
        }

        .demo-board-container {
            position: relative;
            background-color: var(--card-bg);
            padding: 1.5rem;
            border-radius: 2.5rem;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
        }

        @media (min-width: 768px) {
            .demo-board-container {
                padding: 2rem;
            }
        }

        .demo-header {
            text-align: center;
            margin-bottom: 1.5rem;
        }

        .demo-title {
            font-size: 1.25rem;
            font-weight: 900;
            color: white;
            text-transform: uppercase;
            letter-spacing: -0.025em;
            margin-bottom: 0.75rem;
        }

        .demo-price-badge {
            display: inline-block;
            margin-top: 0.75rem;
            background-color: var(--primary-orange);
            color: black;
            font-weight: 900;
            font-size: 0.625rem;
            padding: 0.5rem 1.5rem;
            border-radius: 0.375rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            box-shadow: 0 10px 15px -3px rgba(249, 115, 22, 0.1);
        }

        .demo-flyer {
            margin-bottom: 1.5rem;
            border-radius: 1rem;
            border: 2px solid rgba(249, 115, 22, 0.3);
            overflow: hidden;
            background-color: black;
            position: relative;
            transition: all 0.7s;
        }

        .demo-flyer:hover {
            transform: scale(1.02);
        }

        .demo-flyer-img {
            width: 100%;
            height: 100%;
            object-fit: contain;
        }

        .demo-flyer-caption {
            position: absolute;
            bottom: 0;
            left: 0;
            right: 0;
            padding: 1rem;
            background: linear-gradient(to top, rgba(0, 0, 0, 0.95), transparent);
        }

        .demo-flyer-text {
            color: white;
            font-size: 0.625rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-style: italic;
        }

        .demo-grid-container {
            background-color: #222;
            padding: 1rem;
            border-radius: 1rem;
            border: 1px solid var(--border-color);
        }

        .demo-grid {
            display: grid;
            grid-template-columns: repeat(10, 1fr);
            gap: 0.375rem;
            margin-bottom: 1.5rem;
        }

        .demo-square {
            aspect-ratio: 1;
            border-radius: 0.25rem;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            font-size: 0.625rem;
            font-weight: 700;
            border-top: 1px solid rgba(255, 255, 255, 0.2);
        }

        .demo-square.available {
            background-color: #ffcc00;
            color: #121212;
        }

        .demo-square.available:hover {
            background-color: #ffd633;
        }

        .demo-square.selected {
            background-color: #4caf50;
            color: white;
            transform: scale(1.1);
            z-index: 10;
            box-shadow: 0 10px 15px -3px rgba(76, 175, 80, 0.5);
        }

        .demo-square.reserved {
            background-color: rgba(255, 77, 77, 0.5);
            color: rgba(255, 255, 255, 0.4);
            cursor: not-allowed;
        }

        .demo-square.sold {
            background-color: #444;
            color: rgba(255, 255, 255, 0.1);
            cursor: not-allowed;
        }

        .demo-legend {
            display: grid;
            grid-template-columns: repeat(2, 1fr);
            gap: 0.75rem;
            padding: 1rem;
            background-color: var(--card-bg);
            border-radius: 0.75rem;
            border: 1px solid var(--border-color);
        }

        .legend-item {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .legend-color {
            width: 1rem;
            height: 1rem;
            border-radius: 0.125rem;
        }

        .legend-text {
            font-size: 0.5625rem;
            font-weight: 700;
            color: #94a3b8;
            text-transform: uppercase;
        }

        .demo-remaining {
            text-align: center;
            margin-top: 1.5rem;
            color: var(--primary-orange);
            font-weight: 900;
            font-size: 0.75rem;
            font-style: italic;
            text-transform: uppercase;
            letter-spacing: 0.15em;
        }

        /* Logic Cards Section */
        .logic-section {
            padding: 6rem 1.5rem;
            background-color: #0a0a0a;
        }

        /* No Signup Banner */
        .no-signup-banner {
            background: linear-gradient(135deg, rgba(249, 115, 22, 0.15) 0%, rgba(249, 115, 22, 0.05) 100%);
            border-top: 1px solid rgba(249, 115, 22, 0.3);
            border-bottom: 1px solid rgba(249, 115, 22, 0.3);
            padding: 2rem 1.5rem;
        }

        .no-signup-content {
            max-width: 1280px;
            margin: 0 auto;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 1.5rem;
        }

        .no-signup-content svg {
            color: var(--primary-orange);
            flex-shrink: 0;
        }

        .no-signup-text h3 {
            font-size: 1.5rem;
            font-weight: 900;
            font-style: italic;
            text-transform: uppercase;
            color: white;
            margin-bottom: 0.25rem;
            letter-spacing: 0.05em;
        }

        .no-signup-text p {
            color: #94a3b8;
            font-weight: 600;
            font-size: 0.875rem;
        }

        @media (max-width: 640px) {
            .no-signup-content {
                flex-direction: column;
                text-align: center;
            }
            
            .no-signup-text h3 {
                font-size: 1.125rem;
            }
        }

        /* Active Fundraisers Section */
        .active-fundraisers-section {
            padding: 6rem 1.5rem;
            background-color: #0a0a0a;
            border-top: 1px solid var(--border-color);
        }

        .fundraisers-container {
            max-width: 1280px;
            margin: 0 auto;
        }

        .fundraisers-header {
            text-align: center;
            margin-bottom: 4rem;
        }

        .section-title {
            font-size: 2.5rem;
            font-weight: 900;
            font-style: italic;
            text-transform: uppercase;
            color: white;
            margin-bottom: 1rem;
        }

        @media (min-width: 768px) {
            .section-title {
                font-size: 3rem;
            }
        }

        .section-subtitle {
            color: #94a3b8;
            font-size: 1.125rem;
        }

        .fundraisers-grid {
            display: grid;
            gap: 2rem;
            grid-template-columns: 1fr;
        }

        @media (min-width: 640px) {
            .fundraisers-grid {
                grid-template-columns: repeat(2, 1fr);
            }
        }

        @media (min-width: 1024px) {
            .fundraisers-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .fundraiser-card {
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1.5rem;
            overflow: hidden;
            transition: all 0.3s;
            cursor: pointer;
        }

        .fundraiser-card:hover {
            border-color: var(--primary-orange);
            transform: translateY(-4px);
            box-shadow: 0 20px 50px -12px rgba(249, 115, 22, 0.3);
        }

        .fundraiser-banner {
            width: 100%;
            aspect-ratio: 16/9;
            object-fit: cover;
            background-color: #1a1a1a;
        }

        .fundraiser-content {
            padding: 1.5rem;
        }

        .fundraiser-title {
            font-size: 1.25rem;
            font-weight: 900;
            font-style: italic;
            text-transform: uppercase;
            color: white;
            margin-bottom: 0.75rem;
        }

        .fundraiser-desc {
            color: #94a3b8;
            font-size: 0.875rem;
            margin-bottom: 1.25rem;
            line-height: 1.6;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
            overflow: hidden;
        }

        .fundraiser-stats {
            display: flex;
            justify-content: space-between;
            align-items: center;
            padding-top: 1rem;
            padding-bottom: 1rem;
            border-top: 1px solid var(--border-color);
            margin-bottom: 1rem;
        }

        .fundraiser-price {
            color: var(--primary-orange);
            font-weight: 900;
            font-style: italic;
            font-size: 1.125rem;
        }

        .fundraiser-remaining {
            color: #94a3b8;
            font-size: 0.875rem;
            font-weight: 600;
        }

        .fundraiser-btn {
            width: 100%;
            background-color: var(--primary-orange);
            color: white;
            padding: 0.875rem 1.5rem;
            border-radius: 0.75rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.1em;
            font-size: 0.875rem;
            border: none;
            cursor: pointer;
            transition: all 0.2s;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
        }

        .fundraiser-btn:hover {
            background-color: #ea580c;
            transform: translateY(-2px);
            box-shadow: 0 10px 25px -5px rgba(249, 115, 22, 0.4);
        }

        .fundraiser-btn svg {
            width: 16px;
            height: 16px;
        }

        .fundraisers-loading {
            grid-column: 1 / -1;
            text-align: center;
            padding: 4rem 0;
            color: #94a3b8;
        }

        .loading-spinner {
            width: 48px;
            height: 48px;
            border: 4px solid rgba(249, 115, 22, 0.2);
            border-top-color: var(--primary-orange);
            border-radius: 50%;
            animation: spin 1s linear infinite;
            margin: 0 auto 1rem;
        }

        @keyframes spin {
            to { transform: rotate(360deg); }
        }

        .fundraisers-empty {
            grid-column: 1 / -1;
            text-align: center;
            padding: 4rem 0;
            color: #94a3b8;
        }

        .fundraisers-empty p {
            margin-top: 1rem;
            font-size: 1.125rem;
        }

        .fundraisers-empty .cta-button {
            margin-top: 1.5rem;
        }

        .fundraisers-empty svg {
            color: #475569;
        }

        .logic-grid {
            max-width: 1280px;
            margin: 0 auto;
            display: grid;
            gap: 3rem;
        }

        @media (min-width: 768px) {
            .logic-grid {
                grid-template-columns: repeat(3, 1fr);
            }
        }

        .logic-card {
            padding: 2rem;
            background-color: var(--card-bg);
            border: 1px solid var(--border-color);
            border-radius: 1.5rem;
            transition: border-color 0.3s;
        }

        .logic-card:hover {
            border-color: rgba(249, 115, 22, 0.5);
        }

        .logic-icon {
            margin-bottom: 1.5rem;
            color: var(--primary-orange);
        }

        .logic-title {
            font-size: 1.25rem;
            font-weight: 900;
            font-style: italic;
            text-transform: uppercase;
            color: white;
            margin-bottom: 1rem;
            transition: color 0.3s;
        }

        .logic-card:hover .logic-title {
            color: var(--primary-orange);
        }

        .logic-desc {
            color: #94a3b8;
            font-weight: 500;
            line-height: 1.7;
        }

        /* CTA Section */
        .cta-section {
            padding: 6rem 1.5rem;
            border-top: 1px solid var(--border-color);
            background: linear-gradient(to bottom, var(--background-dark), black);
        }

        .cta-container {
            max-width: 56rem;
            margin: 0 auto;
            text-align: center;
        }

        .cta-icon-wrapper {
            margin-bottom: 2rem;
            display: inline-block;
            padding: 1rem;
            background-color: rgba(255, 255, 255, 0.05);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 1rem;
        }

        .cta-title {
            font-size: 2.5rem;
            font-weight: 900;
            font-style: italic;
            text-transform: uppercase;
            color: white;
            margin-bottom: 1.5rem;
        }

        @media (min-width: 768px) {
            .cta-title {
                font-size: 3rem;
            }
        }

        .cta-desc {
            color: #94a3b8;
            font-size: 1.125rem;
            margin-bottom: 2.5rem;
            max-width: 36rem;
            margin-left: auto;
            margin-right: auto;
        }

        .cta-button {
            background-color: var(--primary-orange);
            color: white;
            padding: 1.25rem 2.5rem;
            border-radius: 1rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-size: 1.125rem;
            border: none;
            cursor: pointer;
            box-shadow: 0 25px 50px -12px rgba(249, 115, 22, 0.2);
            transition: all 0.2s;
        }

        .cta-button:hover {
            transform: scale(1.05);
        }

        /* Footer */
        footer {
            padding: 3rem 1.5rem;
            border-top: 1px solid var(--border-color);
        }

        .footer-container {
            max-width: 1280px;
            margin: 0 auto;
            display: flex;
            flex-direction: column;
            align-items: center;
            gap: 2rem;
        }

        @media (min-width: 768px) {
            .footer-container {
                flex-direction: row;
                justify-content: space-between;
            }
        }

        /* ============================================ */
        /* MOBILE-FIRST RESPONSIVE OPTIMIZATIONS */
        /* ============================================ */

        /* Mobile Base - applies to all screens, overridden by larger breakpoints */
        @media (max-width: 767px) {
            /* Tighter padding for mobile */
            body {
                padding: 0;
            }

            /* Navigation - Mobile optimized */
            nav {
                padding: 0.75rem 0;
            }

            .nav-container {
                padding: 0 1rem;
            }

            .nav-logo-text {
                font-size: 1rem;
            }

            .nav-logo-img {
                height: 28px;
            }

            .mobile-menu-btn {
                padding: 0.75rem;
                -webkit-tap-highlight-color: transparent;
            }

            .mobile-menu {
                padding: 1rem;
                gap: 1rem;
            }

            .nav-btn {
                width: 100%;
                text-align: center;
                justify-content: center;
            }

            /* Hero Section - Mobile */
            .hero {
                padding-top: 5rem;
                padding-bottom: 3rem;
            }

            .hero-container {
                padding: 0 1rem;
                gap: 2rem;
            }

            .hero-badge {
                font-size: 0.5625rem;
                padding: 0.375rem 0.875rem;
            }

            .hero-title {
                font-size: 2rem;
                line-height: 1;
                margin-bottom: 1.5rem;
            }

            .hero-description {
                font-size: 1rem;
                margin-top: 1.5rem;
                line-height: 1.6;
            }

            .hero-buttons {
                margin-top: 2rem;
                flex-direction: column;
                width: 100%;
            }

            .hero-cta-primary,
            .hero-feature-badge {
                width: 100%;
                justify-content: center;
                padding: 1rem 1.5rem;
            }

            .hero-feature-badge {
                height: auto;
                padding: 0.875rem 1.5rem;
            }

            /* Demo Board - Mobile */
            .demo-board-container {
                padding: 1rem;
                border-radius: 1.5rem;
            }

            .demo-header {
                margin-bottom: 1rem;
            }

            .demo-title {
                font-size: 1rem;
            }

            .demo-price-badge {
                font-size: 0.5625rem;
                padding: 0.375rem 1rem;
            }

            .demo-grid-container {
                padding: 0.75rem;
                border-radius: 0.75rem;
            }

            .demo-grid {
                gap: 0.25rem;
                margin-bottom: 1rem;
            }

            .demo-square {
                font-size: 0.5rem;
                border-radius: 0.2rem;
            }

            .demo-legend {
                grid-template-columns: 1fr;
                gap: 0.5rem;
                padding: 0.75rem;
            }

            .legend-text {
                font-size: 0.5rem;
            }

            .demo-remaining {
                margin-top: 1rem;
                font-size: 0.625rem;
            }

            /* Logic Section - Mobile */
            .logic-section {
                padding: 3rem 1rem;
            }

            .section-title {
                font-size: 1.75rem;
                margin-bottom: 0.75rem;
            }

            .section-subtitle {
                font-size: 1rem;
            }

            /* No Signup Banner - Mobile */
            .no-signup-banner {
                padding: 1.5rem 1rem;
            }

            .no-signup-content {
                gap: 1rem;
            }

            .no-signup-content svg {
                width: 36px;
                height: 36px;
            }

            .no-signup-text h3 {
                font-size: 1rem;
                letter-spacing: 0.025em;
            }

            .no-signup-text p {
                font-size: 0.75rem;
            }

            /* Active Fundraisers - Mobile */
            .active-fundraisers-section {
                padding: 3rem 1rem;
            }

            .fundraisers-container {
                padding: 0;
            }

            .fundraisers-header {
                margin-bottom: 2rem;
            }

            .fundraisers-grid {
                gap: 1.5rem;
            }

            .fundraiser-card {
                border-radius: 1rem;
            }

            .fundraiser-content {
                padding: 1.25rem;
            }

            .fundraiser-title {
                font-size: 1.125rem;
            }

            .fundraiser-desc {
                font-size: 0.875rem;
            }

            .fundraiser-btn {
                padding: 0.75rem 1.25rem;
                font-size: 0.625rem;
            }

            /* Footer - Mobile */
            footer {
                padding: 2rem 1rem;
            }

            .footer-container {
                gap: 1.5rem;
            }

            .footer-logo-text {
                font-size: 0.625rem;
            }

            .footer-text {
                font-size: 0.5rem;
                letter-spacing: 0.2em;
            }

            /* Modals - Mobile optimized */
            .modal {
                padding: 1.5rem;
                width: 95%;
                max-width: none;
                border-radius: 1.5rem;
                max-height: 90vh;
                overflow-y: auto;
            }

            .modal-close {
                top: 0.75rem;
                right: 0.75rem;
                padding: 0.5rem;
                -webkit-tap-highlight-color: transparent;
            }

            .modal-logo-box img {
                height: 32px;
            }

            .modal h2 {
                font-size: 1.25rem;
            }

            .modal p {
                font-size: 0.875rem;
            }

            .modal input,
            .modal select,
            .modal textarea {
                font-size: 16px; /* Prevents zoom on iOS */
                padding: 0.875rem;
            }

            .modal button {
                padding: 0.875rem 1.5rem;
                font-size: 0.75rem;
                -webkit-tap-highlight-color: transparent;
            }

            /* Touch-friendly buttons */
            button,
            .nav-btn,
            .hero-cta-primary,
            .fundraiser-btn {
                min-height: 44px; /* iOS recommended touch target */
                -webkit-tap-highlight-color: transparent;
                touch-action: manipulation;
            }

            /* Better scrolling on mobile */
            body,
            .modal {
                -webkit-overflow-scrolling: touch;
            }

            /* Hide elements that are too large on mobile */
            .demo-flyer-caption {
                padding: 0.5rem;
            }

            .demo-flyer-text {
                font-size: 0.5rem;
            }
        }

        /* Small phones (< 375px) */
        @media (max-width: 374px) {
            .hero-title {
                font-size: 1.75rem;
            }

            .nav-logo-text {
                font-size: 0.875rem;
            }

            .section-title {
                font-size: 1.5rem;
            }

            .demo-grid {
                gap: 0.15rem;
            }

            .demo-square {
                font-size: 0.4rem;
            }

            .modal {
                padding: 1rem;
            }
        }

        /* Landscape mobile optimization */
        @media (max-height: 500px) and (orientation: landscape) {
            .hero {
                padding-top: 4rem;
                padding-bottom: 2rem;
            }

            .hero-title {
                font-size: 1.5rem;
            }

            .modal {
                max-height: 85vh;
                padding: 1rem;
            }
        }

        .footer-logo {
            display: flex;
            align-items: center;
            gap: 0.75rem;
        }

        .footer-logo-img {
            background: white;
            padding: 0.25rem;
            border-radius: 0.25rem;
            height: 20px;
            width: auto;
        }

        .footer-logo-text {
            font-weight: 900;
            letter-spacing: -0.05em;
            color: white;
            font-style: italic;
            text-transform: uppercase;
            font-size: 0.75rem;
        }

        .footer-text {
            color: #64748b;
            font-size: 0.5625rem;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.4em;
        }

        /* Icons (SVG inline) */
        .icon {
            width: 18px;
            height: 18px;
            stroke: currentColor;
            stroke-width: 2;
            stroke-linecap: round;
            stroke-linejoin: round;
            fill: none;
        }

        .icon-lg {
            width: 28px;
            height: 28px;
        }

        .icon-xl {
            width: 40px;
            height: 40px;
        }

        /* Modals */
        .modal-overlay {
            display: none;
            position: fixed;
            top: 0;
            left: 0;
            right: 0;
            bottom: 0;
            background-color: rgba(0, 0, 0, 0.8);
            z-index: 9998;
        }

        .modal-overlay.active {
            display: block;
        }

        .modal {
            display: none;
            position: fixed;
            top: 50%;
            left: 50%;
            transform: translate(-50%, -50%);
            background-color: var(--card-bg);
            border-radius: 2.5rem;
            padding: 3rem;
            z-index: 9999;
            max-width: 500px;
            width: 90%;
            border: 1px solid rgba(255, 255, 255, 0.1);
            box-shadow: 0 25px 50px -12px rgba(0, 0, 0, 0.5);
            overflow: hidden;
        }

        .modal.active {
            display: block;
        }

        .modal-decoration {
            position: absolute;
            top: -6rem;
            right: -6rem;
            width: 12rem;
            height: 12rem;
            background-color: rgba(249, 115, 22, 0.1);
            border-radius: 50%;
            filter: blur(60px);
        }

        .modal-close {
            position: absolute;
            top: 1rem;
            right: 1rem;
            background: none;
            border: none;
            color: #94a3b8;
            cursor: pointer;
            font-size: 1.5rem;
        }

        .modal-logo-wrapper {
            display: flex;
            justify-content: center;
            margin-bottom: 2rem;
        }

        .modal-logo-box {
            background: white;
            padding: 0.5rem;
            border-radius: 0.75rem;
            display: inline-block;
        }

        .modal-logo-box img {
            height: 40px;
            width: auto;
        }

        .modal-title {
            font-size: 1.875rem;
            font-weight: 900;
            color: white;
            text-align: center;
            text-transform: uppercase;
            font-style: italic;
            letter-spacing: -0.05em;
            margin-bottom: 0.5rem;
        }

        .modal-title span {
            color: var(--primary-orange);
        }

        .modal-subtitle {
            text-align: center;
            color: #64748b;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-size: 0.625rem;
            margin-bottom: 2.5rem;
        }

        .form-group {
            margin-bottom: 1.5rem;
            position: relative;
        }

        .form-label {
            display: block;
            color: #64748b;
            font-size: 0.625rem;
            font-weight: 900;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            margin-bottom: 0.75rem;
            margin-left: 0.25rem;
        }

        .input-wrapper {
            position: relative;
        }

        .input-icon {
            position: absolute;
            left: 1rem;
            top: 50%;
            transform: translateY(-50%);
            color: #475569;
            width: 18px;
            height: 18px;
        }

        .form-input {
            width: 100%;
            padding: 1rem 1rem 1rem 3rem;
            background-color: rgba(0, 0, 0, 0.4);
            border: 1px solid rgba(255, 255, 255, 0.1);
            border-radius: 0.75rem;
            color: white;
            font-size: 1rem;
            font-weight: 500;
            transition: all 0.2s;
        }

        .form-input::placeholder {
            color: #334155;
        }

        .form-input:focus {
            outline: none;
            border-color: rgba(249, 115, 22, 0.5);
            box-shadow: 0 0 0 1px rgba(249, 115, 22, 0.5);
        }

        .form-remember {
            display: flex;
            align-items: center;
            justify-content: space-between;
            padding: 0.5rem 0;
            margin-bottom: 1.5rem;
        }

        .checkbox-wrapper {
            display: flex;
            align-items: center;
            gap: 0.5rem;
        }

        .form-checkbox {
            accent-color: var(--primary-orange);
            width: 1rem;
            height: 1rem;
            border-radius: 0.25rem;
            cursor: pointer;
        }

        .checkbox-label {
            color: #64748b;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-size: 0.5625rem;
            cursor: pointer;
        }

        .forgot-password {
            color: var(--primary-orange);
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-size: 0.5625rem;
            background: none;
            border: none;
            cursor: pointer;
            text-decoration: none;
        }

        .forgot-password:hover {
            text-decoration: underline;
        }

        .form-button {
            width: 100%;
            padding: 1rem;
            background-color: var(--primary-orange);
            color: white;
            border: none;
            border-radius: 0.75rem;
            font-weight: 900;
            font-size: 0.875rem;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            cursor: pointer;
            display: flex;
            align-items: center;
            justify-content: center;
            gap: 0.5rem;
            box-shadow: 0 25px 50px -12px rgba(249, 115, 22, 0.1);
            transition: all 0.2s;
        }

        .form-button:hover {
            background-color: #ea580c;
        }

        .form-button:active {
            transform: scale(0.95);
        }

        .form-link {
            text-align: center;
            margin-top: 2rem;
            color: #475569;
            font-weight: 700;
            text-transform: uppercase;
            letter-spacing: 0.15em;
            font-size: 0.5625rem;
        }

        .form-link a {
            color: white;
            text-decoration: none;
            transition: color 0.2s;
        }

        .form-link a:hover {
            color: var(--primary-orange);
        }
    </style>
</head>
<body>
    <!-- Navigation -->
    <nav id="nav">
        <div class="nav-container">
            <div class="nav-logo">
                <img src="new-logo.png" alt="SquareFund" class="nav-logo-img">
                <span class="nav-logo-text">SQUARE<span>FUND</span></span>
            </div>

            <div class="nav-desktop">
                <a href="#demo" class="nav-link">
                    <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                    View Active SquareFund Boards
                </a>
                
                <button class="nav-link" onclick="showSignInModal()">
                    <svg class="icon" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                    Sign In
                </button>
                
                <button class="nav-btn" onclick="showSignUpModal()">
                    Start My Own Square Fund Board Today
                </button>
            </div>

            <button class="mobile-menu-btn" onclick="toggleMobileMenu()">
                <svg id="menuIcon" class="icon" viewBox="0 0 24 24"><line x1="3" y1="12" x2="21" y2="12"/><line x1="3" y1="6" x2="21" y2="6"/><line x1="3" y1="18" x2="21" y2="18"/></svg>
                <svg id="closeIcon" class="icon" viewBox="0 0 24 24" style="display: none;"><line x1="18" y1="6" x2="6" y2="18"/><line x1="6" y1="6" x2="18" y2="18"/></svg>
            </button>
        </div>

        <div id="mobileMenu" class="mobile-menu hidden">
            <button class="nav-link" onclick="scrollToDemo()">
                <svg class="icon" viewBox="0 0 24 24"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                View Active SquareFund Boards
            </button>
            <button class="nav-link" onclick="showSignInModal()">
                <svg class="icon" viewBox="0 0 24 24"><path d="M20 21v-2a4 4 0 0 0-4-4H8a4 4 0 0 0-4 4v2"/><circle cx="12" cy="7" r="4"/></svg>
                Sign In
            </button>
            <button class="nav-btn" onclick="showSignUpModal()">
                Start My Own Square Fund Board Today
            </button>
        </div>
    </nav>

    <!-- Hero Section -->
    <header class="hero">
        <div class="hero-container">
            <div class="hero-content">
                <div class="hero-badge">
                    REPLACING THE CARDBOARD GRID
                </div>
                <h1 class="hero-title">
                    DIGITAL <br>
                    SQUARES. <br>
                    <span>ZERO FEES.</span>
                </h1>
                <p class="hero-description">
                    Create high-performance 50-square fundraisers just like AADS. No more paper grids—collect Interac e-Transfers directly and use our automated randomizer to crown winners.
                </p>
                
                <div class="hero-buttons">
                    <button class="hero-cta-primary" onclick="showSignUpModal()">
                        Launch My Free Board
                        <svg class="icon" viewBox="0 0 24 24"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                    </button>
                    <div class="hero-feature-badge">
                        <svg class="icon" style="color: var(--primary-orange);" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
                        <span class="hero-feature-text">E-Transfer Optimized</span>
                    </div>
                </div>
            </div>

            <!-- Demo Board -->
            <div id="demo" class="demo-board">
                <div class="demo-board-container">
                    <div class="demo-header">
                        <h3 class="demo-title">AADS Square Fundraiser 2</h3>
                        <div class="demo-price-badge">
                            ENTRY: $5.00 PER SQUARE
                        </div>
                    </div>

                    <!-- Flyer Area -->
                    <div class="demo-flyer" style="aspect-ratio: 1/1;">
                        <img src="new-logo.png" alt="SquareFund Logo" class="demo-flyer-img">
                        <div class="demo-flyer-caption">
                            <p class="demo-flyer-text">Sports Fundraising Made Easy</p>
                        </div>
                    </div>

                    <!-- 5x10 Grid -->
                    <div class="demo-grid-container">
                        <div class="demo-grid" id="demoGrid"></div>

                        <!-- Legend -->
                        <div class="demo-legend">
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #ffcc00;"></div>
                                <span class="legend-text">Available to Purchase</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #4caf50;"></div>
                                <span class="legend-text">Selected & Reserved</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: rgba(255, 77, 77, 0.5);"></div>
                                <span class="legend-text">Reserved by Others</span>
                            </div>
                            <div class="legend-item">
                                <div class="legend-color" style="background-color: #444;"></div>
                                <span class="legend-text">Sold</span>
                            </div>
                        </div>

                        <div class="demo-remaining">
                            Squares Remaining: <span id="remaining">44</span> / 50
                        </div>
                    </div>
                </div>
            </div>
        </div>
    </header>

    <!-- No Signup Banner -->
    <div class="no-signup-banner">
        <div class="no-signup-content">
            <svg class="icon-lg" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round">
                <path d="M12 22s8-4 8-10V5l-8-3-8 3v7c0 6 8 10 8 10z"/>
                <path d="M9 12l2 2 4-4"/>
            </svg>
            <div class="no-signup-text">
                <h3>PURCHASE SQUARES • NO SIGN UP</h3>
                <p>100% Hassle Free • Zero Fees • Instant Access</p>
            </div>
        </div>
    </div>

    <!-- Active Fundraisers Section -->
    <section class="active-fundraisers-section">
        <div class="fundraisers-container">
            <div class="fundraisers-header">
                <h2 class="section-title">ACTIVE FUNDRAISERS</h2>
                <p class="section-subtitle">Browse live boards and support your favorite teams</p>
            </div>
            <div id="fundraisersGrid" class="fundraisers-grid">
                <!-- Loading state -->
                <div class="fundraisers-loading">
                    <div class="loading-spinner"></div>
                    <p>Loading active fundraisers...</p>
                </div>
            </div>
            <div id="fundraisersEmpty" class="fundraisers-empty" style="display: none;">
                <svg class="icon-xl" style="color: #475569;" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2"><rect x="3" y="3" width="7" height="7"/><rect x="14" y="3" width="7" height="7"/><rect x="14" y="14" width="7" height="7"/><rect x="3" y="14" width="7" height="7"/></svg>
                <p>No active fundraisers at the moment</p>
                <button class="cta-button" style="margin-top: 1.5rem;" onclick="showSignUpModal()">
                    Create Your Own Board
                </button>
            </div>
        </div>
    </section>

    <!-- Logic Cards Section -->
    <section class="logic-section">
        <div class="logic-grid">
            <div class="logic-card">
                <div class="logic-icon">
                    <svg class="icon-lg" viewBox="0 0 24 24"><rect x="5" y="2" width="14" height="20" rx="2" ry="2"/><line x1="12" y1="18" x2="12.01" y2="18"/></svg>
                </div>
                <h3 class="logic-title">SMS Notification</h3>
                <p class="logic-desc">Get an instant text alert the moment a square is purchased. No more checking the board every 5 minutes.</p>
            </div>

            <div class="logic-card">
                <div class="logic-icon">
                    <svg class="icon-lg" viewBox="0 0 24 24"><rect x="1" y="4" width="22" height="16" rx="2" ry="2"/><line x1="1" y1="10" x2="23" y2="10"/></svg>
                </div>
                <h3 class="logic-title">e-Transfer Easy</h3>
                <p class="logic-desc">Supporters pick their lucky number and send payment via Interac. Fast, secure, and no processing fees.</p>
            </div>

            <div class="logic-card">
                <div class="logic-icon">
                    <svg class="icon-lg" viewBox="0 0 24 24"><rect x="2" y="10" width="20" height="12" rx="2" ry="2"/><path d="M7 10V8a5 5 0 0 1 9.9-1"/></svg>
                </div>
                <h3 class="logic-title">Fair Randomizer</h3>
                <p class="logic-desc">Forget the dice. Use the built-in all-in-one randomizer to generate winning numbers fairly and instantly.</p>
            </div>
        </div>
    </section>

    <!-- CTA Section -->
    <section class="cta-section">
        <div class="cta-container">
            <div class="cta-icon-wrapper">
                <svg class="icon-xl" style="color: var(--primary-orange);" viewBox="0 0 24 24"><path d="M6 9H4.5a2.5 2.5 0 0 1 0-5H6"/><path d="M18 9h1.5a2.5 2.5 0 0 0 0-5H18"/><path d="M4 22h16"/><path d="M10 14.66V17c0 .55-.47.98-.97 1.21C7.85 18.75 7 20.24 7 22"/><path d="M14 14.66V17c0 .55.47.98.97 1.21C16.15 18.75 17 20.24 17 22"/><path d="M18 2H6v7a6 6 0 0 0 12 0V2Z"/></svg>
            </div>
            <h2 class="cta-title">READY TO WIN?</h2>
            <p class="cta-desc">
                Join the dozens of teams using SquareFund for a better, cleaner, and 100% free fundraising experience.
            </p>
            <button class="cta-button" onclick="showSignUpModal()">
                Start My Own Square Fund Board Today
            </button>
        </div>
    </section>

    <!-- Footer -->
    <footer>
        <div class="footer-container">
            <div class="footer-logo">
                <img src="new-logo.png" alt="Logo" class="footer-logo-img">
                <span class="footer-logo-text">SQUAREFUND</span>
            </div>
            <p class="footer-text">Sports Fundraising Made Easy • No Fees</p>
        </div>
    </footer>

    <!-- Sign In Modal -->
    <div id="signInOverlay" class="modal-overlay"></div>
    <div id="signInModal" class="modal">
        <div class="modal-decoration"></div>
        <button class="modal-close" onclick="closeSignInModal()">×</button>
        
        <div style="position: relative; z-index: 10;">
            <div class="modal-logo-wrapper">
                <div class="modal-logo-box">
                    <img src="new-logo.png" alt="Logo">
                </div>
            </div>
            
            <h2 class="modal-title">Welcome <span>Back</span></h2>
            <p class="modal-subtitle">Sign in to manage your fundraisers</p>

            <form id="signInForm" onsubmit="signIn(event)">
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <div class="input-wrapper">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                        <input type="email" id="signInEmail" class="form-input" placeholder="name@example.com" required autocomplete="email">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <div class="input-wrapper">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                        <input type="password" id="signInPassword" class="form-input" placeholder="••••••••" required autocomplete="current-password">
                    </div>
                </div>

                <div class="form-remember">
                    <div class="checkbox-wrapper">
                        <input type="checkbox" id="rememberMe" class="form-checkbox">
                        <label for="rememberMe" class="checkbox-label">Remember me</label>
                    </div>
                    <button type="button" class="forgot-password">Forgot Password?</button>
                </div>

                <button type="submit" class="form-button">
                    Sign Into Account
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                </button>

                <div class="form-link">
                    Don't have an account? <a href="#" onclick="switchToSignUp()">Create one now</a>
                </div>
            </form>
        </div>
    </div>

    <!-- Sign Up Modal -->
    <div id="signUpOverlay" class="modal-overlay"></div>
    <div id="signUpModal" class="modal">
        <div class="modal-decoration"></div>
        <button class="modal-close" onclick="closeSignUpModal()">×</button>
        
        <div style="position: relative; z-index: 10;">
            <div class="modal-logo-wrapper">
                <div class="modal-logo-box">
                    <img src="new-logo.png" alt="Logo">
                </div>
            </div>
            
            <h2 class="modal-title">Start <span>Fundraising</span></h2>
            <p class="modal-subtitle">Create your free account today</p>

            <form id="signUpForm" onsubmit="signUp(event)">
                <div class="form-group">
                    <label class="form-label">Email Address</label>
                    <div class="input-wrapper">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="2" y="4" width="20" height="16" rx="2"/><path d="m22 7-8.97 5.7a1.94 1.94 0 0 1-2.06 0L2 7"/></svg>
                        <input type="email" id="signUpEmail" class="form-input" placeholder="name@example.com" required autocomplete="email">
                    </div>
                </div>
                <div class="form-group">
                    <label class="form-label">Password</label>
                    <div class="input-wrapper">
                        <svg class="input-icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><rect x="3" y="11" width="18" height="11" rx="2" ry="2"/><path d="M7 11V7a5 5 0 0 1 10 0v4"/></svg>
                        <input type="password" id="signUpPassword" class="form-input" placeholder="••••••••" required minlength="6" autocomplete="new-password">
                    </div>
                </div>

                <button type="submit" class="form-button">
                    Create Account
                    <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2" stroke-linecap="round" stroke-linejoin="round"><line x1="5" y1="12" x2="19" y2="12"/><polyline points="12 5 19 12 12 19"/></svg>
                </button>

                <div class="form-link">
                    Already have an account? <a href="#" onclick="switchToSignIn()">Sign In</a>
                </div>
            </form>
        </div>
    </div>

    <script>
        // Supabase Configuration
        const SUPABASE_URL = 'https://xsmrquoivqrxalxjqxdw.supabase.co';
        const SUPABASE_ANON_KEY = 'eyJhbGciOiJIUzI1NiIsInR5cCI6IkpXVCJ9.eyJpc3MiOiJzdXBhYmFzZSIsInJlZiI6InhzbXJxdW9pdnFyeGFseGpxeGR3Iiwicm9sZSI6ImFub24iLCJpYXQiOjE3Njk2NTkxNzUsImV4cCI6MjA4NTIzNTE3NX0.uJAVb4k61Oxja15NUuiC8_TtxhzWtAC-dlh-nepTKdU';
        const supabaseClient = window.supabase.createClient(SUPABASE_URL, SUPABASE_ANON_KEY);

        // Navigation scroll effect
        window.addEventListener('scroll', () => {
            const nav = document.getElementById('nav');
            if (window.scrollY > 20) {
                nav.classList.add('scrolled');
            } else {
                nav.classList.remove('scrolled');
            }
        });

        // Mobile menu toggle
        function toggleMobileMenu() {
            const menu = document.getElementById('mobileMenu');
            const menuIcon = document.getElementById('menuIcon');
            const closeIcon = document.getElementById('closeIcon');
            
            menu.classList.toggle('hidden');
            if (menu.classList.contains('hidden')) {
                menuIcon.style.display = 'block';
                closeIcon.style.display = 'none';
            } else {
                menuIcon.style.display = 'none';
                closeIcon.style.display = 'block';
            }
        }

        // Scroll to demo
        function scrollToDemo() {
            document.getElementById('demo').scrollIntoView({ behavior: 'smooth' });
            const menu = document.getElementById('mobileMenu');
            menu.classList.add('hidden');
            document.getElementById('menuIcon').style.display = 'block';
            document.getElementById('closeIcon').style.display = 'none';
        }

        // Demo grid
        let selectedSquare = null;
        const soldSquares = [4, 12, 25, 42];
        const reservedSquares = [8, 19];

        function initDemoGrid() {
            const grid = document.getElementById('demoGrid');
            for (let i = 1; i <= 50; i++) {
                const square = document.createElement('div');
                square.className = 'demo-square';
                square.textContent = i;
                
                if (soldSquares.includes(i)) {
                    square.classList.add('sold');
                } else if (reservedSquares.includes(i)) {
                    square.classList.add('reserved');
                } else {
                    square.classList.add('available');
                    square.onclick = () => selectDemoSquare(i);
                }
                
                grid.appendChild(square);
            }
            updateRemaining();
        }

        function selectDemoSquare(num) {
            const squares = document.querySelectorAll('.demo-square');
            squares.forEach(sq => {
                if (parseInt(sq.textContent) === selectedSquare) {
                    sq.classList.remove('selected');
                    sq.classList.add('available');
                }
            });
            
            if (selectedSquare === num) {
                selectedSquare = null;
            } else {
                selectedSquare = num;
                squares.forEach(sq => {
                    if (parseInt(sq.textContent) === num) {
                        sq.classList.remove('available');
                        sq.classList.add('selected');
                    }
                });
            }
        }

        function updateRemaining() {
            const totalUnavailable = soldSquares.length + reservedSquares.length;
            document.getElementById('remaining').textContent = 50 - totalUnavailable;
        }

        // Modal functions
        function showSignInModal() {
            document.getElementById('signInModal').classList.add('active');
            document.getElementById('signInOverlay').classList.add('active');
        }

        function closeSignInModal() {
            document.getElementById('signInModal').classList.remove('active');
            document.getElementById('signInOverlay').classList.remove('active');
        }

        function showSignUpModal() {
            document.getElementById('signUpModal').classList.add('active');
            document.getElementById('signUpOverlay').classList.add('active');
        }

        function closeSignUpModal() {
            document.getElementById('signUpModal').classList.remove('active');
            document.getElementById('signUpOverlay').classList.remove('active');
        }

        function switchToSignUp() {
            closeSignInModal();
            showSignUpModal();
        }

        function switchToSignIn() {
            closeSignUpModal();
            showSignInModal();
        }

        // Close modals on overlay click
        document.getElementById('signInOverlay').onclick = closeSignInModal;
        document.getElementById('signUpOverlay').onclick = closeSignUpModal;

        // Auth functions
        async function signIn(event) {
            event.preventDefault();
            const email = document.getElementById('signInEmail').value;
            const password = document.getElementById('signInPassword').value;

            try {
                const { data, error } = await supabaseClient.auth.signInWithPassword({
                    email: email,
                    password: password,
                });

                if (error) throw error;

                alert('Sign in successful!');
                window.location.href = 'admin.html';
            } catch (error) {
                alert('Error signing in: ' + error.message);
            }
        }

        async function signUp(event) {
            event.preventDefault();
            const email = document.getElementById('signUpEmail').value;
            const password = document.getElementById('signUpPassword').value;

            try {
                const { data, error } = await supabaseClient.auth.signUp({
                    email: email,
                    password: password,
                });

                if (error) throw error;

                alert('Account created! Please check your email to verify your account.');
                closeSignUpModal();
            } catch (error) {
                alert('Error creating account: ' + error.message);
            }
        }

        // Initialize
        initDemoGrid();
        loadActiveFundraisers();

        // Check if user is already signed in (no longer auto-redirects)
        async function checkAuth() {
            const { data: { user } } = await supabaseClient.auth.getUser();
            // Allow signed-in users to view landing page
            // They can navigate to admin via the nav button
        }

        checkAuth();

        // Load active fundraisers
        async function loadActiveFundraisers() {
            const grid = document.getElementById('fundraisersGrid');
            const emptyState = document.getElementById('fundraisersEmpty');

            try {
                // Query active fundraisers with squares count
                const { data: fundraisers, error } = await supabaseClient
                    .from('fundraisers')
                    .select('*, squares(square_number, sold)')
                    .eq('is_active', true)
                    .order('created_at', { ascending: false });

                if (error) throw error;

                // Clear loading state
                grid.innerHTML = '';

                if (!fundraisers || fundraisers.length === 0) {
                    emptyState.style.display = 'block';
                    return;
                }

                // Render fundraiser cards
                fundraisers.forEach(fundraiser => {
                    const soldCount = fundraiser.squares?.filter(s => s.sold).length || 0;
                    const remainingCount = 50 - soldCount;
                    const fundraiserUrl = `squares.html?id=${fundraiser.id}`;

                    const card = document.createElement('div');
                    card.className = 'fundraiser-card';
                    card.onclick = () => {
                        window.location.href = fundraiserUrl;
                    };

                    // Use banner or fallback to default logo
                    const bannerUrl = fundraiser.banner_url || 'new-logo.png';

                    card.innerHTML = `
                        <img src="${bannerUrl}" alt="${fundraiser.title}" class="fundraiser-banner" onerror="this.src='new-logo.png'">
                        <div class="fundraiser-content">
                            <h3 class="fundraiser-title">${fundraiser.title}</h3>
                            <p class="fundraiser-desc">${fundraiser.description || 'Support this fundraiser!'}</p>
                            <div class="fundraiser-stats">
                                <span class="fundraiser-price">$${fundraiser.square_price.toFixed(2)}</span>
                                <span class="fundraiser-remaining">${remainingCount} / 50 left</span>
                            </div>
                            <button class="fundraiser-btn" onclick="event.stopPropagation(); window.location.href='${fundraiserUrl}'">
                                View Board
                                <svg class="icon" viewBox="0 0 24 24" fill="none" stroke="currentColor" stroke-width="2">
                                    <line x1="5" y1="12" x2="19" y2="12"/>
                                    <polyline points="12 5 19 12 12 19"/>
                                </svg>
                            </button>
                        </div>
                    `;

                    grid.appendChild(card);
                });
            } catch (error) {
                console.error('Error loading fundraisers:', error);
                grid.innerHTML = '<div class="fundraisers-loading"><p style="color: #ff4d4d;">Error loading fundraisers. Please try again.</p></div>';
            }
        }
    </script>

    <!-- Floating AI Help Button -->
    <button class="floating-help-btn" onclick="openHelper()" title="AI Help Agent">
        <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
            <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M8.228 9c.549-1.165 2.03-2 3.772-2 2.21 0 4 1.343 4 3 0 1.4-1.278 2.575-3.006 2.907-.542.104-.994.54-.994 1.093m0 3h.01M21 12a9 9 0 11-18 0 9 9 0 0118 0z"></path>
        </svg>
    </button>

    <!-- Helper Modal -->
    <div class="helper-modal" id="helperModal" onclick="closeHelperIfOutside(event)">
        <button class="helper-close" onclick="closeHelper()">
            <svg fill="none" stroke="currentColor" viewBox="0 0 24 24">
                <path stroke-linecap="round" stroke-linejoin="round" stroke-width="2" d="M6 18L18 6M6 6l12 12"></path>
            </svg>
        </button>
        <iframe id="helperFrame" src=""></iframe>
    </div>

    <script>
        function openHelper() {
            const modal = document.getElementById('helperModal');
            const iframe = document.getElementById('helperFrame');
            iframe.src = 'helper.html';
            modal.classList.add('active');
            document.body.style.overflow = 'hidden';
        }

        function closeHelper() {
            const modal = document.getElementById('helperModal');
            modal.classList.remove('active');
            document.body.style.overflow = '';
            setTimeout(() => {
                document.getElementById('helperFrame').src = '';
            }, 300);
        }

        function closeHelperIfOutside(event) {
            if (event.target.id === 'helperModal') {
                closeHelper();
            }
        }

        // Close on Escape key
        document.addEventListener('keydown', (e) => {
            if (e.key === 'Escape') closeHelper();
        });
    </script>
</body>
</html>
